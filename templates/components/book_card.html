<!-- Book Card Component -->
<div class="flex flex-col">
    <div class="relative w-[8rem] h-[8rem] sm:w-[10rem] sm:h-[10rem] rounded-md overflow-hidden shadow shadow-black items-center justify-center flex">
        {% if book.cover_image %}
            <img class="object-cover w-full h-full hover:scale-110 transition-transform duration-500 ease-in-out"
                 height="128"
                 width="128"
                 src="{{ book.cover_image }}"
                 alt="{{ book.title }}" />
        {% else %}
            {% include "icons/photo-off.html" %}
        {% endif %}
        
        <!-- Request Button -->
        <button class="absolute top-0 right-0 rounded-none rounded-bl-md btn-sm btn btn-square items-center justify-center flex {% if book.downloaded or book.already_requested %}btn-ghost bg-success text-neutral/20{% else %}btn-info{% endif %}"
                hx-post="{{ base_url }}/search/request/{{ book.asin }}"
                hx-disabled-elt="this"
                hx-target="closest div.flex"
                hx-swap="outerHTML"
                hx-on:click="this.disabled = true;"
                {% if book.downloaded or book.already_requested %}disabled{% endif %}>
            <input type="hidden" name="redirect_to_home" value="true" />
            {% if book.downloaded or book.already_requested %}
                <span>{% include "icons/checkmark.html" %}</span>
            {% else %}
                {% if auto_start_download and user.can_download() %}
                    <span>{% include "icons/download.html" %}</span>
                {% else %}
                    <span>{% include "icons/plus.html" %}</span>
                {% endif %}
            {% endif %}
        </button>
    </div>
    
    <!-- Book Info -->
    {% if book.asin %}
        <a class="text-sm text-primary font-bold pt-1"
           title="{{ book.title }}"
           target="_blank"
           href="https://audible.com/pd/{{ book.asin }}?ipRedirectOverride=true"
           style="display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
            {{ book.title }}
        </a>
    {% else %}
        <div class="text-sm text-primary font-bold pt-1"
             title="{{ book.title }}"
             style="display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
            {{ book.title }}
        </div>
    {% endif %}
    
    {% if book.subtitle %}
        <div class="opacity-60 font-semibold text-xs" 
             title="{{ book.subtitle }}"
             style="display: -webkit-box; -webkit-line-clamp: 1; line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">
            {{ book.subtitle }}
        </div>
    {% endif %}
    
    <div class="text-xs font-semibold" 
         title="Authors: {{ book.authors | join(', ') }}"
         style="display: -webkit-box; -webkit-line-clamp: 1; line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">
        {% for author in book.authors[:2] %}
            <a href="{{ base_url }}/search?q={{ author }}"
               title="Search for {{ author }}"
               class="hover:underline">
                {{ author }}
                {{- "," if loop.index < book.authors | length and loop.index < 2 else "" -}}
            </a>
        {% endfor %}
        {% if book.authors | length > 2 %}
            <span class="opacity-60">+{{ book.authors | length - 2 }} more</span>
        {% endif %}
    </div>
    
    <!-- Runtime -->
    {% if book.runtime_length_hrs %}
        <div class="text-xs opacity-60 mt-1">
            {{ book.runtime_length_hrs }}h
        </div>
    {% endif %}
</div>